
{
  "rules": {
    "users": {
      ".indexOn": ["email", "organizationId", "portfolio/public", "displayName"],
      "$userId": {
        ".read": "data.child('portfolio/public').val() === true || (auth != null && (auth.uid === $userId || root.child('users').child(auth.uid).child('isAdmin').val() === true || root.child('users').child(auth.uid).child('isOrganizationAdmin').val() === true))",
        ".write": "auth != null && (auth.uid === $userId || (root.child('users').child(auth.uid).child('isAdmin').val() === true && (root.child('users').child(auth.uid).child('adminExpiresAt').val() == null || root.child('users').child(auth.uid).child('adminExpiresAt').val() > now)))",
        "purchasedCourses": {
          "$courseId": {
            ".write": "auth != null && ((root.child('users').child(auth.uid).child('isAdmin').val() === true && (root.child('users').child(auth.uid).child('adminExpiresAt').val() == null || root.child('users').child(auth.uid).child('adminExpiresAt').val() > now)) || (auth.uid === $userId && !data.exists()))"
          }
        },
        "isOnline": { ".write": "auth != null && auth.uid === $userId" },
        "lastSeen": { ".write": "auth != null && auth.uid === $userId" }
      }
    },
    "courses": {
      ".read": true,
      ".write": "auth != null && (root.child('users').child(auth.uid).child('isAdmin').val() === true && (root.child('users').child(auth.uid).child('adminExpiresAt').val() == null || root.child('users').child(auth.uid).child('adminExpiresAt').val() > now))"
    },
    "blog": {
      ".read": true,
      ".write": "auth != null && (root.child('users').child(auth.uid).child('isAdmin').val() === true && (root.child('users').child(auth.uid).child('adminExpiresAt').val() == null || root.child('users').child(auth.uid).child('adminExpiresAt').val() > now))",
      ".indexOn": ["slug", "createdAt"]
    },
    "programs": {
      ".read": true,
      ".write": "auth != null && (root.child('users').child(auth.uid).child('isAdmin').val() === true && (root.child('users').child(auth.uid).child('adminExpiresAt').val() == null || root.child('users').child(auth.uid).child('adminExpiresAt').val() > now))"
    },
    "bundles": {
      ".read": true,
      ".write": "auth != null && (root.child('users').child(auth.uid).child('isAdmin').val() === true && (root.child('users').child(auth.uid).child('adminExpiresAt').val() == null || root.child('users').child(auth.uid).child('adminExpiresAt').val() > now))"
    },
    "bootcamps": {
      ".read": true,
      ".write": "auth != null && (auth.uid === newData.child('participants').child(auth.uid).name() || (root.child('users').child(auth.uid).child('isAdmin').val() === true && (root.child('users').child(auth.uid).child('adminExpiresAt').val() == null || root.child('users').child(auth.uid).child('adminExpiresAt').val() > now)))"
    },
    "hackathons": {
      ".read": true,
      ".write": "auth != null && (auth.uid === newData.child('participants').child(auth.uid).name() || (root.child('users').child(auth.uid).child('isAdmin').val() === true && (root.child('users').child(auth.uid).child('adminExpiresAt').val() == null || root.child('users').child(auth.uid).child('adminExpiresAt').val() > now)))"
    },
    "leaderboard": {
      ".read": true,
      ".indexOn": "score",
      "$userId": {
        ".write": "auth != null && (auth.uid === $userId || (root.child('users').child(auth.uid).child('isAdmin').val() === true && (root.child('users').child(auth.uid).child('adminExpiresAt').val() == null || root.child('users').child(auth.uid).child('adminExpiresAt').val() > now)))"
      }
    },
    "calendarEvents": {
      ".read": "auth != null",
      ".write": "auth != null && (root.child('users').child(auth.uid).child('isAdmin').val() === true && (root.child('users').child(auth.uid).child('adminExpiresAt').val() == null || root.child('users').child(auth.uid).child('adminExpiresAt').val() > now))"
    },
    "organizations": {
      ".read": "auth != null",
      ".indexOn": "ownerId",
      "$orgId": {
        ".write": "auth != null && ((root.child('users').child(auth.uid).child('isAdmin').val() === true && (root.child('users').child(auth.uid).child('adminExpiresAt').val() == null || root.child('users').child(auth.uid).child('adminExpiresAt').val() > now)) || (data.exists() && data.child('ownerId').val() === auth.uid) || (!data.exists() && newData.child('ownerId').val() === auth.uid))"
      }
    },
    "invitations": {
      ".read": "true",
      ".write": "auth != null && ((root.child('users').child(auth.uid).child('isAdmin').val() === true && (root.child('users').child(auth.uid).child('adminExpiresAt').val() == null || root.child('users').child(auth.uid).child('adminExpiresAt').val() > now)) || root.child('users').child(auth.uid).child('isOrganizationAdmin').val() === true)"
    },
    "userNotes": {
      "$userId": {
        ".read": "auth != null && auth.uid === $userId",
        ".write": "auth != null && auth.uid === $userId"
      }
    },
    "tutorHistory": {
      "$userId": {
        ".read": "auth != null && auth.uid === $userId",
        ".write": "auth != null && auth.uid === $userId"
      }
    },
    "submissions": {
      ".indexOn": "userId",
      "$submissionId": {
        ".read": "auth != null && (data.child('userId').val() === auth.uid || (root.child('users').child(auth.uid).child('isAdmin').val() === true && (root.child('users').child(auth.uid).child('adminExpiresAt').val() == null || root.child('users').child(auth.uid).child('adminExpiresAt').val() > now)))",
        ".write": "auth != null && ((newData.child('userId').val() === auth.uid) || (root.child('users').child(auth.uid).child('isAdmin').val() === true && (root.child('users').child(auth.uid).child('adminExpiresAt').val() == null || root.child('users').child(auth.uid).child('adminExpiresAt').val() > now)))"
      }
    },
    "hackathonSubmissions": {
      ".indexOn": ["userId", "hackathonId"],
      "$submissionId": {
        ".read": "auth != null && (data.child('userId').val() === auth.uid || (root.child('users').child(auth.uid).child('isAdmin').val() === true && (root.child('users').child(auth.uid).child('adminExpiresAt').val() == null || root.child('users').child(auth.uid).child('adminExpiresAt').val() > now)))",
        ".write": "auth != null && (newData.child('userId').val() === auth.uid || (root.child('users').child(auth.uid).child('isAdmin').val() === true && (root.child('users').child(auth.uid).child('adminExpiresAt').val() == null || root.child('users').child(auth.uid).child('adminExpiresAt').val() > now)))"
      }
    },
     "projectSubmissions": {
      "$submissionId": {
        ".read": "auth != null && (data.child('userId').val() === auth.uid || (root.child('users').child(auth.uid).child('isAdmin').val() === true && (root.child('users').child(auth.uid).child('adminExpiresAt').val() == null || root.child('users').child(auth.uid).child('adminExpiresAt').val() > now)))",
        ".write": "auth != null && (newData.child('userId').val() === auth.uid || (root.child('users').child(auth.uid).child('isAdmin').val() === true && (root.child('users').child(auth.uid).child('adminExpiresAt').val() == null || root.child('users').child(auth.uid).child('adminExpiresAt').val() > now)))"
      }
    },
    "courseFeedback": {
      "$courseId": {
        ".read": "auth != null && (root.child('users').child(auth.uid).child('isAdmin').val() === true && (root.child('users').child(auth.uid).child('adminExpiresAt').val() == null || root.child('users').child(auth.uid).child('adminExpiresAt').val() > now))",
        ".write": "auth != null"
      }
    },
    "discussions": {
      ".read": "auth != null",
      "threads": {
        "$courseId": {
          ".write": "auth != null",
          ".indexOn": "createdAt"
        }
      },
      "replies": {
        "$threadId": {
          ".write": "auth != null",
          ".indexOn": "createdAt"
        }
      }
    },
    "permissionRequests": {
      ".read": "auth != null && root.child('users').child(auth.uid).child('isSuperAdmin').val() === true",
      ".write": "auth != null"
    },
    "notifications": {
      ".read": "auth != null",
      "$notificationId": {
        ".write": "auth != null"
      }
    },
    "contactMessages": {
      ".read": "auth != null && (root.child('users').child(auth.uid).child('isAdmin').val() === true && (root.child('users').child(auth.uid).child('adminExpiresAt').val() == null || root.child('users').child(auth.uid).child('adminExpiresAt').val() > now))",
      ".write": "auth != null",
      ".indexOn": "createdAt"
    },
    "forms": {
      ".read": "auth != null",
      ".write": "auth != null && (root.child('users').child(auth.uid).child('isAdmin').val() === true && (root.child('users').child(auth.uid).child('adminExpiresAt').val() == null || root.child('users').child(auth.uid).child('adminExpiresAt').val() > now))"
    },
    "formSubmissions": {
      ".read": "auth != null && ((root.child('users').child(auth.uid).child('isAdmin').val() === true && (root.child('users').child(auth.uid).child('adminExpiresAt').val() == null || root.child('users').child(auth.uid).child('adminExpiresAt').val() > now)) || query.orderByChild === 'userId' && query.equalTo === auth.uid)",
      ".indexOn": ["formId", "userId"],
      "$submissionId": {
          ".write": "auth != null"
      }
    },
     "userActivity": {
      ".read": "auth != null && (root.child('users').child(auth.uid).child('isAdmin').val() === true && (root.child('users').child(auth.uid).child('adminExpiresAt').val() == null || root.child('users').child(auth.uid).child('adminExpiresAt').val() > now))",
      "$logId": {
        ".write": "auth != null && newData.child('userId').val() === auth.uid",
        ".validate": "newData.hasChildren(['userId', 'userName', 'userAvatar', 'type', 'details', 'timestamp'])"
      }
    },
    "referrals": {
      ".read": "auth != null",
      ".indexOn": "affiliateId"
    },
    "webrtc-offers": {
      ".read": "auth != null",
      ".write": "auth != null && ((root.child('users').child(auth.uid).child('isAdmin').val() === true && (root.child('users').child(auth.uid).child('adminExpiresAt').val() == null || root.child('users').child(auth.uid).child('adminExpiresAt').val() > now)) || root.child('users').child(auth.uid).child('isOrganizationAdmin').val() === true)"
    },
    "webrtc-answers": {
      "$sessionId": {
        "$userId": {
          ".read": "auth != null",
          ".write": "auth != null && auth.uid === $userId"
        }
      }
    },
    "webrtc-candidates": {
      ".read": "auth != null",
      ".write": "auth != null"
    },
    "liveChat": {
      "$sessionId": {
        ".read": "auth != null",
        ".write": "auth != null"
      }
    },
    "liveReactions": {
      ".read": "auth != null",
      ".write": "auth != null"
    },
    "apiUsage": {
      ".read": "auth != null && (root.child('users').child(auth.uid).child('isAdmin').val() === true && (root.child('users').child(auth.uid).child('adminExpiresAt').val() == null || root.child('users').child(auth.uid).child('adminExpiresAt').val() > now))",
      "$userId": {
        ".read": "auth != null && auth.uid === $userId",
        ".write": "auth != null && auth.uid === $userId"
      }
    },
    "apiKeys": {
      ".read": false,
      "$userId": {
        ".read": "auth != null && auth.uid === $userId",
        ".write": "auth != null && auth.uid === $userId"
      }
    },
    "hero": {
      ".read": true,
      ".write": "auth != null && (root.child('users').child(auth.uid).child('isAdmin').val() === true && (root.child('users').child(auth.uid).child('adminExpiresAt').val() == null || root.child('users').child(auth.uid).child('adminExpiresAt').val() > now))"
    },
    "tutorSettings": {
      ".read": true,
      ".write": "auth != null && (root.child('users').child(auth.uid).child('isAdmin').val() === true && (root.child('users').child(auth.uid).child('adminExpiresAt').val() == null || root.child('users').child(auth.uid).child('adminExpiresAt').val() > now))"
    },
    "certificateSettings": {
      ".read": true,
      ".write": "auth != null && (root.child('users').child(auth.uid).child('isAdmin').val() === true && (root.child('users').child(auth.uid).child('adminExpiresAt').val() == null || root.child('users').child(auth.uid).child('adminExpiresAt').val() > now))"
    },
    "pricingPlans": {
      ".read": true,
      ".write": "auth != null && (root.child('users').child(auth.uid).child('isAdmin').val() === true && (root.child('users').child(auth.uid).child('adminExpiresAt').val() == null || root.child('users').child(auth.uid).child('adminExpiresAt').val() > now))"
    },
    "advertisements": {
      ".read": true,
      ".write": "auth != null && (root.child('users').child(auth.uid).child('isAdmin').val() === true && (root.child('users').child(auth.uid).child('adminExpiresAt').val() == null || root.child('users').child(auth.uid).child('adminExpiresAt').val() > now))"
    },
    "teamMembers": {
      ".read": true,
      ".write": "auth != null && (root.child('users').child(auth.uid).child('isAdmin').val() === true && (root.child('users').child(auth.uid).child('adminExpiresAt').val() == null || root.child('users').child(auth.uid).child('adminExpiresAt').val() > now))"
    },
    "$other": {
        ".read": "auth != null",
        ".write": "auth != null"
    }
  }
}
